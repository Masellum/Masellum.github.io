

<!DOCTYPE html>
<html lang="zh-CN" xmlns:v-bind="http://www.w3.org/1999/xhtml">

<head>
    <!-- hexo-inject:begin --><!-- hexo-inject:end --><title>[NOIP2013] 货车运输 - Mas&#39;s Blog</title>
<meta charset="utf-8">
<meta name="X-UA-Compatible" content="IE=edge">
<meta name="author" content="Masellum Guo">
<meta name="description" content=" ">
<meta name="keywords" content="">

<link rel="alternate" type="application/atom+xml" title="ATOM 1.0" href="/atom.xml">

    <meta charset="utf-8">
    <meta name="X-UA-Compatible" content="IE=edge">
    <meta content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" name="viewport">
    <meta content="telephone=no" name="format-detection">
    <meta name="renderer" content="webkit">
    <meta name="theme-color" content="#ffffff">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.1.3/dist/css/bootstrap.min.css" integrity="sha256-eSi1q2PG6J7g7ib17yAaWMcrr5GrtohYChqibrV7PBE=" crossorigin="anonymous">
<link rel="stylesheet" href="/css/journal.css?94047913">
<script src="/js/loadCSS.js"></script>
<script>
    loadCSS("https://fonts.googleapis.com/css?family=Lora|Montserrat|Fira+Mono|Material+Icons");
    (function (d) {
        var config = {
                kitId: 'dwg1tuc',
                scriptTimeout: 3000,
                async: true
            },
            h = d.documentElement, t = setTimeout(function () {
                h.className = h.className.replace(/\bwf-loading\b/g, "") + " wf-inactive";
            }, config.scriptTimeout), tk = d.createElement("script"), f = false,
            s = d.getElementsByTagName("script")[0], a;
        h.className += " wf-loading";
        tk.src = 'https://use.typekit.net/' + config.kitId + '.js';
        tk.async = true;
        tk.onload = tk.onreadystatechange = function () {
            a = this.readyState;
            if (f || a && a != "complete" && a != "loaded") return;
            f = true;
            clearTimeout(t);
            try {
                Typekit.load(config)
            } catch (e) {
            }
        };
        s.parentNode.insertBefore(tk, s)
    })(document);
</script>
<noscript>
    <link rel="stylesheet"
          href="https://fonts.googleapis.com/css?family=Lora|Montserrat|Anonymous+Pro:400|Material+Icons"/>
</noscript>
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.10.0-rc.1/dist/katex.min.css" integrity="sha384-D+9gmBxUQogRLqvARvNLmA9hS2x//eK1FhVb9PiU86gmcrBrJAQT8okdJ4LMp2uv" crossorigin="anonymous">
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.10.0-rc.1/dist/katex.min.js" integrity="sha384-483A6DwYfKeDa0Q52fJmxFXkcPCFfnXMoXblOkJ4JcA8zATN6Tm78UNL72AKk+0O" crossorigin="anonymous"></script><!-- hexo-inject:begin --><link rel='stylesheet' href='https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.5.1/katex.min.css'><!-- hexo-inject:end -->

</head>
<body>
<!-- hexo-inject:begin --><!-- hexo-inject:end --><div id="top"></div>
<div id="app">
<div class="single-column-drawer-container" ref="drawer"
     v-bind:class="{ 'single-column-drawer-container-active': isDrawerOpen }">
    <div class="drawer-content">
        <div class="drawer-menu">
            <a class="a-block drawer-menu-item false" href="https://blog.masellum.me">
                首页
            </a>
            <a class="a-block drawer-menu-item false" href="/archives">
                归档
            </a>

            
            
            <a class="a-block drawer-menu-item false" href="/about.html">
                关于
            </a>
            
            <a class="a-block drawer-menu-item false" href="/links.html">
                朋友们
            </a>
            

            
            <a class="a-block drawer-menu-item" href="/atom.xml">
                RSS
            </a>
            
        </div>
    </div>
</div>
<transition name="fade">
    <div v-bind:class="{ 'single-column-drawer-mask': mounted }" v-if="isDrawerOpen" v-on:click="toggleDrawer"></div>
</transition>
<nav ref="navBar" class="navbar sticky-top navbar-light single-column-nav-container">
    <div ref="navBackground" class="nav-background"></div>
    <div class="container container-narrow nav-content">
        <button id="nav_dropdown_btn" class="nav-dropdown-toggle" type="button" v-on:click="toggleDrawer">
            <i class="material-icons">
                menu
            </i>
        </button>
        <a ref="navTitle" class="navbar-brand" href="/">
            Mas&#39;s Blog
        </a>
    </div>
</nav>
<div class="single-column-header-container" ref="pageHead"
     v-bind:style="{ transform: 'translateZ(0px) translateY('+.3*scrollY+'px)', opacity: 1-navOpacity }">
    <a href="/">
        <div class="single-column-header-title">Mas&#39;s Blog</div>
        <div class="single-column-header-subtitle">Masellum 的生活日志</div>
    </a>
</div>
<div ref="sideContainer" class="side-container">
    <a class="a-block nav-head false" href="/">
        <div class="nav-title">
            Mas's Blog
        </div>
        <div class="nav-subtitle">
            Masellum 的生活日志
        </div>
    </a>

    <div class="nav-link-list">
        <a class="a-block no-tint nav-link-item false" href="/archives">
            归档
        </a>

        
        
        <a class="a-block nav-link-item false" href="/about.html">
            关于
        </a>
        
        <a class="a-block nav-link-item false" href="/links.html">
            朋友们
        </a>
        

        
        <a class="a-block no-tint nav-link-item" href="/atom.xml">
            RSS
        </a>
        
    </div>

    
    <div class="nav-footer">
        Proudly published with Hexo<br>
        
        Theme <a href="https://github.com/SumiMakito/hexo-theme-journal/" target="_blank" rel="noreferrer noopener">Journal.</a> by <a href="https://mak1t0.cc/" target="_blank" rel="noreferrer noopener">Makito</a><br>
        
        &copy; 2019 <a href="https://blog.masellum.me">Mas&#39;s Blog</a>
    </div>
</div>
<div ref="extraContainer" class="extra-container">
    <div class="pagination">
        <a id="globalBackToTop" class="pagination-action animated-visibility" href="#top" :class="{ invisible: scrollY == 0 }">
            <i class="material-icons pagination-action-icon">
                keyboard_arrow_up
            </i>
        </a>

        
    </div>
</div>

<div ref="streamContainer" class="stream-container">
    <div class="post-list-container post-list-container-shadow">
        <div class="post">
            <div class="post-head-wrapper-text-only"
                 style="background-image: url('')">
                <div class="post-title">
                    [NOIP2013] 货车运输
                    <div class="post-meta">
                        <time datetime="2018-08-03T11:11:51.000Z" itemprop="datePublished">
                            2018-08-03 19:11
                        </time>&nbsp;
                        
                        
                        <i class="material-icons" style="">folder</i>
                        
                        <a href='/categories/题解/'>题解</a>
                        
                        
    
                        
                        
                        <i class="material-icons" style="">label</i>
                        
                        <a href='/tags/LCA/'>LCA</a>, 
                        
                        <a href='/tags/生成树/'>生成树</a>
                        
                        
                    </div>
                </div>
            </div>
    
            <div class="post-body-wrapper">
                <div class="post-body">
                    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.10.0-beta/dist/katex.min.css" integrity="sha384-9tPv11A+glH/on/wEu99NVwDPwkMQESOocs/ZGXPoIiLE8MU/qkqUcZ3zzL+6DuH" crossorigin="anonymous"><a id="more"></a>
<h1 id="&#x9898;&#x76EE;">&#x9898;&#x76EE;</h1>
<p><a href="https://www.luogu.org/problemnew/show/P1967" target="_blank" rel="noopener">&#x9898;&#x76EE;&#x94FE;&#x63A5;</a></p>
<h2 id="&#x9898;&#x76EE;&#x63CF;&#x8FF0;">&#x9898;&#x76EE;&#x63CF;&#x8FF0;</h2>
<p>A &#x56FD;&#x6709; <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>n</mi></mrow><annotation encoding="application/x-tex">n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathdefault">n</span></span></span></span> &#x5EA7;&#x57CE;&#x5E02;&#xFF0C;&#x7F16;&#x53F7;&#x4ECE; <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mn>1</mn></mrow><annotation encoding="application/x-tex">1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">1</span></span></span></span> &#x5230; <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>n</mi></mrow><annotation encoding="application/x-tex">n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathdefault">n</span></span></span></span> &#xFF0C;&#x57CE;&#x5E02;&#x4E4B;&#x95F4;&#x6709; <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>m</mi></mrow><annotation encoding="application/x-tex">m</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathdefault">m</span></span></span></span> &#x6761;&#x53CC;&#x5411;&#x9053;&#x8DEF;&#x3002;&#x6BCF;&#x4E00;&#x6761;&#x9053;&#x8DEF;&#x5BF9;&#x8F66;&#x8F86;&#x90FD;&#x6709;&#x91CD;&#x91CF;&#x9650;&#x5236;&#xFF0C;&#x7B80;&#x79F0;&#x9650;&#x91CD;&#x3002;&#x73B0;&#x5728;&#x6709; <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>q</mi></mrow><annotation encoding="application/x-tex">q</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.19444em;"></span><span class="mord mathdefault" style="margin-right:0.03588em;">q</span></span></span></span> &#x8F86;&#x8D27;&#x8F66;&#x5728;&#x8FD0;&#x8F93;&#x8D27;&#x7269;&#xFF0C;&#x53F8;&#x673A;&#x4EEC;&#x60F3;&#x77E5;&#x9053;&#x6BCF;&#x8F86;&#x8F66;&#x5728;&#x4E0D;&#x8D85;&#x8FC7;&#x8F66;&#x8F86;&#x9650;&#x91CD;&#x7684;&#x60C5;&#x51B5;&#x4E0B;&#xFF0C;&#x6700;&#x591A;&#x80FD;&#x8FD0;&#x591A;&#x91CD;&#x7684;&#x8D27;&#x7269;&#x3002;</p>
<h2 id="&#x8F93;&#x5165;&#x8F93;&#x51FA;&#x683C;&#x5F0F;">&#x8F93;&#x5165;&#x8F93;&#x51FA;&#x683C;&#x5F0F;</h2>
<h3 id="&#x8F93;&#x5165;&#x683C;&#x5F0F;">&#x8F93;&#x5165;&#x683C;&#x5F0F;</h3>
<p>&#x7B2C;&#x4E00;&#x884C;&#x6709;&#x4E24;&#x4E2A;&#x7528;&#x4E00;&#x4E2A;&#x7A7A;&#x683C;&#x9694;&#x5F00;&#x7684;&#x6574;&#x6570; <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>n</mi><mo separator="true">,</mo><mi>m</mi></mrow><annotation encoding="application/x-tex">n, m</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.19444em;"></span><span class="mord mathdefault">n</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault">m</span></span></span></span> &#xFF0C;&#x8868;&#x793A; A &#x56FD;&#x6709; <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>n</mi></mrow><annotation encoding="application/x-tex">n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathdefault">n</span></span></span></span> &#x5EA7;&#x57CE;&#x5E02;&#x548C; <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>m</mi></mrow><annotation encoding="application/x-tex">m</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathdefault">m</span></span></span></span> &#x6761;&#x9053;&#x8DEF;&#x3002;</p>
<p>&#x63A5;&#x4E0B;&#x6765; <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>m</mi></mrow><annotation encoding="application/x-tex">m</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathdefault">m</span></span></span></span> &#x884C;&#x6BCF;&#x884C; <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mn>3</mn></mrow><annotation encoding="application/x-tex">3</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">3</span></span></span></span> &#x4E2A;&#x6574;&#x6570; <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>x</mi><mo separator="true">,</mo><mi>y</mi><mo separator="true">,</mo><mi>z</mi></mrow><annotation encoding="application/x-tex">x, y, z</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.19444em;"></span><span class="mord mathdefault">x</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault" style="margin-right:0.03588em;">y</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault" style="margin-right:0.04398em;">z</span></span></span></span> &#xFF0C;&#x6BCF;&#x4E24;&#x4E2A;&#x6574;&#x6570;&#x4E4B;&#x95F4;&#x7528;&#x4E00;&#x4E2A;&#x7A7A;&#x683C;&#x9694;&#x5F00;&#xFF0C;&#x8868;&#x793A;&#x4ECE; <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>x</mi></mrow><annotation encoding="application/x-tex">x</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathdefault">x</span></span></span></span> &#x53F7;&#x57CE;&#x5E02;&#x5230; <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>y</mi></mrow><annotation encoding="application/x-tex">y</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.19444em;"></span><span class="mord mathdefault" style="margin-right:0.03588em;">y</span></span></span></span> &#x53F7;&#x57CE;&#x5E02;&#x6709;&#x4E00;&#x6761;&#x9650;&#x91CD;&#x4E3A; <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>z</mi></mrow><annotation encoding="application/x-tex">z</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.04398em;">z</span></span></span></span> &#x7684;&#x9053;&#x8DEF;&#x3002;&#x6CE8;&#x610F;&#xFF1A; <strong><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>x</mi></mrow><annotation encoding="application/x-tex">x</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathdefault">x</span></span></span></span> &#x4E0D;&#x7B49;&#x4E8E; <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>y</mi></mrow><annotation encoding="application/x-tex">y</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.19444em;"></span><span class="mord mathdefault" style="margin-right:0.03588em;">y</span></span></span></span> &#xFF0C;&#x4E24;&#x5EA7;&#x57CE;&#x5E02;&#x4E4B;&#x95F4;&#x53EF;&#x80FD;&#x6709;&#x591A;&#x6761;&#x9053;&#x8DEF;</strong>&#x3002;</p>
<p>&#x63A5;&#x4E0B;&#x6765;&#x4E00;&#x884C;&#x6709;&#x4E00;&#x4E2A;&#x6574;&#x6570; <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>q</mi></mrow><annotation encoding="application/x-tex">q</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.19444em;"></span><span class="mord mathdefault" style="margin-right:0.03588em;">q</span></span></span></span>&#xFF0C;&#x8868;&#x793A;&#x6709; <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>q</mi></mrow><annotation encoding="application/x-tex">q</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.19444em;"></span><span class="mord mathdefault" style="margin-right:0.03588em;">q</span></span></span></span> &#x8F86;&#x8D27;&#x8F66;&#x9700;&#x8981;&#x8FD0;&#x8D27;&#x3002;</p>
<p>&#x63A5;&#x4E0B;&#x6765; <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>q</mi></mrow><annotation encoding="application/x-tex">q</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.19444em;"></span><span class="mord mathdefault" style="margin-right:0.03588em;">q</span></span></span></span> &#x884C;&#xFF0C;&#x6BCF;&#x884C;&#x4E24;&#x4E2A;&#x6574;&#x6570; <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>x</mi><mo separator="true">,</mo><mi>y</mi></mrow><annotation encoding="application/x-tex">x, y</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.19444em;"></span><span class="mord mathdefault">x</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault" style="margin-right:0.03588em;">y</span></span></span></span> &#xFF0C;&#x4E4B;&#x95F4;&#x7528;&#x4E00;&#x4E2A;&#x7A7A;&#x683C;&#x9694;&#x5F00;&#xFF0C;&#x8868;&#x793A;&#x4E00;&#x8F86;&#x8D27;&#x8F66;&#x9700;&#x8981;&#x4ECE; <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>x</mi></mrow><annotation encoding="application/x-tex">x</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathdefault">x</span></span></span></span> &#x57CE;&#x5E02;&#x8FD0;&#x8F93;&#x8D27;&#x7269;&#x5230; <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>y</mi></mrow><annotation encoding="application/x-tex">y</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.19444em;"></span><span class="mord mathdefault" style="margin-right:0.03588em;">y</span></span></span></span> &#x57CE;&#x5E02;&#xFF0C;&#x6CE8;&#x610F;&#xFF1A;<strong><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>x</mi></mrow><annotation encoding="application/x-tex">x</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathdefault">x</span></span></span></span> &#x4E0D;&#x7B49;&#x4E8E; <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>y</mi></mrow><annotation encoding="application/x-tex">y</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.19444em;"></span><span class="mord mathdefault" style="margin-right:0.03588em;">y</span></span></span></span></strong>&#x3002;</p>
<h3 id="&#x8F93;&#x51FA;&#x683C;&#x5F0F;">&#x8F93;&#x51FA;&#x683C;&#x5F0F;</h3>
<p>&#x5171;&#x6709; <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>q</mi></mrow><annotation encoding="application/x-tex">q</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.19444em;"></span><span class="mord mathdefault" style="margin-right:0.03588em;">q</span></span></span></span> &#x884C;&#xFF0C;&#x6BCF;&#x884C;&#x4E00;&#x4E2A;&#x6574;&#x6570;&#xFF0C;&#x8868;&#x793A;&#x5BF9;&#x4E8E;&#x6BCF;&#x4E00;&#x8F86;&#x8D27;&#x8F66;&#xFF0C;&#x5B83;&#x7684;&#x6700;&#x5927;&#x8F7D;&#x91CD;&#x662F;&#x591A;&#x5C11;&#x3002;&#x5982;&#x679C;&#x8D27;&#x8F66;&#x4E0D;&#x80FD;&#x5230;&#x8FBE;&#x76EE;&#x7684;&#x5730;&#xFF0C;&#x8F93;&#x51FA; <code>-1</code> &#x3002;</p>
<h3 id="&#x8BF4;&#x660E;">&#x8BF4;&#x660E;</h3>
<p>&#x5BF9;&#x4E8E; <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mn>30</mn><mi mathvariant="normal">%</mi></mrow><annotation encoding="application/x-tex">30\%</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.80556em;vertical-align:-0.05556em;"></span><span class="mord">3</span><span class="mord">0</span><span class="mord">%</span></span></span></span> &#x7684;&#x6570;&#x636E;&#xFF0C; <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mn>0</mn><mo>&lt;</mo><mi>n</mi><mo>&lt;</mo><mn>1</mn><mo separator="true">,</mo><mn>000</mn><mo separator="true">,</mo><mn>0</mn><mo>&lt;</mo><mi>m</mi><mo>&lt;</mo><mn>10</mn><mo separator="true">,</mo><mn>000</mn><mo separator="true">,</mo><mn>0</mn><mo>&lt;</mo><mi>q</mi><mo>&lt;</mo><mn>1</mn><mo separator="true">,</mo><mn>000</mn></mrow><annotation encoding="application/x-tex">0 &lt; n &lt; 1,000,0 &lt; m &lt; 10,000,0 &lt; q&lt; 1,000</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68354em;vertical-align:-0.0391em;"></span><span class="mord">0</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">&lt;</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.5782em;vertical-align:-0.0391em;"></span><span class="mord mathdefault">n</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">&lt;</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.8388800000000001em;vertical-align:-0.19444em;"></span><span class="mord">1</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord">0</span><span class="mord">0</span><span class="mord">0</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord">0</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">&lt;</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.5782em;vertical-align:-0.0391em;"></span><span class="mord mathdefault">m</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">&lt;</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.8388800000000001em;vertical-align:-0.19444em;"></span><span class="mord">1</span><span class="mord">0</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord">0</span><span class="mord">0</span><span class="mord">0</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord">0</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">&lt;</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.7335400000000001em;vertical-align:-0.19444em;"></span><span class="mord mathdefault" style="margin-right:0.03588em;">q</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">&lt;</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.8388800000000001em;vertical-align:-0.19444em;"></span><span class="mord">1</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord">0</span><span class="mord">0</span><span class="mord">0</span></span></span></span>&#xFF1B;</p>
<p>&#x5BF9;&#x4E8E; <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mn>60</mn><mi mathvariant="normal">%</mi></mrow><annotation encoding="application/x-tex">60\%</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.80556em;vertical-align:-0.05556em;"></span><span class="mord">6</span><span class="mord">0</span><span class="mord">%</span></span></span></span> &#x7684;&#x6570;&#x636E;&#xFF0C; <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mn>0</mn><mo>&lt;</mo><mi>n</mi><mo>&lt;</mo><mn>1</mn><mo separator="true">,</mo><mn>000</mn><mo separator="true">,</mo><mn>0</mn><mo>&lt;</mo><mi>m</mi><mo>&lt;</mo><mn>50</mn><mo separator="true">,</mo><mn>000</mn><mo separator="true">,</mo><mn>0</mn><mo>&lt;</mo><mi>q</mi><mo>&lt;</mo><mn>1</mn><mo separator="true">,</mo><mn>000</mn></mrow><annotation encoding="application/x-tex">0 &lt; n &lt; 1,000,0 &lt; m &lt; 50,000,0 &lt; q&lt; 1,000</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68354em;vertical-align:-0.0391em;"></span><span class="mord">0</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">&lt;</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.5782em;vertical-align:-0.0391em;"></span><span class="mord mathdefault">n</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">&lt;</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.8388800000000001em;vertical-align:-0.19444em;"></span><span class="mord">1</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord">0</span><span class="mord">0</span><span class="mord">0</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord">0</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">&lt;</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.5782em;vertical-align:-0.0391em;"></span><span class="mord mathdefault">m</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">&lt;</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.8388800000000001em;vertical-align:-0.19444em;"></span><span class="mord">5</span><span class="mord">0</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord">0</span><span class="mord">0</span><span class="mord">0</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord">0</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">&lt;</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.7335400000000001em;vertical-align:-0.19444em;"></span><span class="mord mathdefault" style="margin-right:0.03588em;">q</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">&lt;</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.8388800000000001em;vertical-align:-0.19444em;"></span><span class="mord">1</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord">0</span><span class="mord">0</span><span class="mord">0</span></span></span></span>&#xFF1B;</p>
<p>&#x5BF9;&#x4E8E; <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mn>100</mn><mi mathvariant="normal">%</mi></mrow><annotation encoding="application/x-tex">100\%</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.80556em;vertical-align:-0.05556em;"></span><span class="mord">1</span><span class="mord">0</span><span class="mord">0</span><span class="mord">%</span></span></span></span> &#x7684;&#x6570;&#x636E;&#xFF0C;<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mn>0</mn><mo>&lt;</mo><mi>n</mi><mo>&lt;</mo><mn>10</mn><mo separator="true">,</mo><mn>000</mn><mo separator="true">,</mo><mn>0</mn><mo>&lt;</mo><mi>m</mi><mo>&lt;</mo><mn>50</mn><mo separator="true">,</mo><mn>000</mn><mo separator="true">,</mo><mn>0</mn><mo>&lt;</mo><mi>q</mi><mo>&lt;</mo><mn>30</mn><mo separator="true">,</mo><mn>000</mn><mo separator="true">,</mo><mn>0</mn><mo>&#x2264;</mo><mi>z</mi><mo>&#x2264;</mo><mn>100</mn><mo separator="true">,</mo><mn>000</mn></mrow><annotation encoding="application/x-tex">0 &lt; n &lt; 10,000,0 &lt; m &lt; 50,000,0 &lt; q&lt; 30,000,0 \le z \le 100,000</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68354em;vertical-align:-0.0391em;"></span><span class="mord">0</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">&lt;</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.5782em;vertical-align:-0.0391em;"></span><span class="mord mathdefault">n</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">&lt;</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.8388800000000001em;vertical-align:-0.19444em;"></span><span class="mord">1</span><span class="mord">0</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord">0</span><span class="mord">0</span><span class="mord">0</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord">0</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">&lt;</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.5782em;vertical-align:-0.0391em;"></span><span class="mord mathdefault">m</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">&lt;</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.8388800000000001em;vertical-align:-0.19444em;"></span><span class="mord">5</span><span class="mord">0</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord">0</span><span class="mord">0</span><span class="mord">0</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord">0</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">&lt;</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.7335400000000001em;vertical-align:-0.19444em;"></span><span class="mord mathdefault" style="margin-right:0.03588em;">q</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">&lt;</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.8388800000000001em;vertical-align:-0.19444em;"></span><span class="mord">3</span><span class="mord">0</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord">0</span><span class="mord">0</span><span class="mord">0</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord">0</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">&#x2264;</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.7719400000000001em;vertical-align:-0.13597em;"></span><span class="mord mathdefault" style="margin-right:0.04398em;">z</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">&#x2264;</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.8388800000000001em;vertical-align:-0.19444em;"></span><span class="mord">1</span><span class="mord">0</span><span class="mord">0</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord">0</span><span class="mord">0</span><span class="mord">0</span></span></span></span>&#x3002;</p>
<h1 id="&#x9898;&#x89E3;">&#x9898;&#x89E3;</h1>
<p>&#x7B80;&#x5316;&#x9898;&#x610F;&#x4E3A;&#x5728;&#x65E0;&#x5411;&#x56FE;&#x4E0A;&#x6C42;&#x7ED9;&#x5B9A;&#x4E24;&#x70B9;&#x95F4;&#x8DEF;&#x5F84;&#x4E0A;&#x8FB9;&#x6743;&#x7684;&#x6700;&#x5C0F;&#x503C;&#x7684;&#x6700;&#x5927;&#x503C;&#x3002;</p>
<p>&#x663E;&#x7136;&#x5F53;&#x8FD9;&#x6761;&#x8DEF;&#x5F84;&#x5728;&#x65E0;&#x5411;&#x56FE;&#x7684;&#x6700;&#x5927;&#x751F;&#x6210;&#x6811;&#x4E0A;&#x65F6;&#x8DEF;&#x5F84;&#x4E0A;&#x5404;&#x8FB9;&#x8FB9;&#x6743;&#x7684;&#x6700;&#x5C0F;&#x503C;&#x6700;&#x5927;&#xFF0C;&#x5426;&#x5219;&#x4E00;&#x5B9A;&#x80FD;&#x5728;&#x6700;&#x5927;&#x751F;&#x6210;&#x6811;&#x4E0A;&#x627E;&#x5230;&#x4E00;&#x6761;&#x8DEF;&#x5F84;&#x4F7F;&#x6700;&#x5C0F;&#x503C;&#x6BD4;&#x5F53;&#x524D;&#x6700;&#x5C0F;&#x503C;&#x66F4;&#x5927;&#x3002;</p>
<p>&#x6C42;&#x6700;&#x5927;&#x751F;&#x6210;&#x6811;&#x7684;&#x7B97;&#x6CD5;&#x4E0E;&#x6C42;&#x6700;&#x5C0F;&#x751F;&#x6210;&#x6811;&#x7684;&#x7B97;&#x6CD5;&#x57FA;&#x672C;&#x76F8;&#x540C;&#xFF0C;&#x53EA;&#x662F;&#x628A;&#x6BCF;&#x6B21;&#x9009;&#x62E9;&#x6700;&#x5C0F;&#x503C;&#x6362;&#x6210;&#x9009;&#x62E9;&#x6700;&#x5927;&#x503C;&#x3002;</p>
<p>&#x80FD;&#x6EE1;&#x8DB3;&#x6240;&#x6C42;&#x7684;&#x8DEF;&#x5F84;&#x5373;&#x4E3A;&#x6700;&#x5927;&#x751F;&#x6210;&#x6811;&#x4E0A;&#x4E24;&#x70B9;&#x95F4;&#x7684;&#x6700;&#x77ED;&#x8DEF;&#x5F84;&#x3002;&#x5BF9;&#x4E8E;&#x6BCF;&#x4E2A;&#x8BE2;&#x95EE;&#xFF0C;&#x5728;&#x6700;&#x5927;&#x751F;&#x6210;&#x6811;&#x4E0A;&#x6C42;&#x4E24;&#x70B9;&#x7684; LCA&#xFF0C;&#x7136;&#x540E;&#x4ECE;&#x4E24;&#x4E2A;&#x70B9;&#x4F9D;&#x6B21;&#x5411;&#x4E0A;&#x8D70;&#x5230; LCA&#xFF0C;&#x6C42;&#x8DEF;&#x5F84;&#x4E0A;&#x7684;&#x6700;&#x5C0F;&#x8FB9;&#x6743;&#x5373;&#x4E3A;&#x8FD9;&#x4E2A;&#x8BE2;&#x95EE;&#x7684;&#x7B54;&#x6848;&#x3002;</p>
<p>&#x9700;&#x8981;&#x6CE8;&#x610F;&#x7684;&#x662F;&#x56FE;&#x4E0D;&#x4FDD;&#x8BC1;&#x8054;&#x901A;&#xFF0C;&#x56E0;&#x6B64;&#x6C42; LCA &#x7684;&#x65F6;&#x5019;&#x5E94;&#x5224;&#x65AD;&#x4E24;&#x70B9;&#x662F;&#x5426;&#x5728;&#x6700;&#x5927;&#x751F;&#x6210;&#x68EE;&#x6797;&#xFF08;&#x2026;&#x2026;&#x53EF;&#x4EE5;&#x8FD9;&#x4E48;&#x53EB;&#x5417;&#xFF09;&#x4E2D;&#x7684;&#x540C;&#x4E00;&#x68F5;&#x6811;&#x4E0A;&#xFF0C;&#x4E0D;&#x662F;&#x7684;&#x8BDD;&#x8F93;&#x51FA; <code>-1</code> &#x3002;</p>
<h1 id="&#x4EE3;&#x7801;">&#x4EE3;&#x7801;</h1>
<p>&#xFF08;&#x5199;&#x5F97;&#x53C8;&#x4E11;&#x53C8;&#x957F;&#xFF08;&#x5411;&#x6700;&#x5927;&#x751F;&#x6210;&#x6811;&#x4E2D;&#x52A0;&#x8FB9;&#x90A3;&#x4E2A;&#x6784;&#x9020;&#x51FD;&#x6570;&#x975E;&#x5E38;&#x6BD2;&#x7624;&#xFF08;&#x662F;&#x56E0;&#x4E3A;&#x6211;&#x5199;&#x5230;&#x540E;&#x6765;&#x53D1;&#x73B0;&#x4E0D;&#x5BF9;&#x4F46;&#x662F;&#x61D2;&#x5F97;&#x91CD;&#x6784;&#x4E86;&#xFF08;&#x9003;</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb1-1"><a href="#cb1-1"></a><span class="pp">#include </span><span class="im">&lt;cmath&gt;</span></span>
<span id="cb1-2"><a href="#cb1-2"></a><span class="pp">#include </span><span class="im">&lt;ctime&gt;</span></span>
<span id="cb1-3"><a href="#cb1-3"></a><span class="pp">#include </span><span class="im">&lt;cstdio&gt;</span></span>
<span id="cb1-4"><a href="#cb1-4"></a><span class="pp">#include </span><span class="im">&lt;climits&gt;</span></span>
<span id="cb1-5"><a href="#cb1-5"></a><span class="pp">#include </span><span class="im">&lt;cstdlib&gt;</span></span>
<span id="cb1-6"><a href="#cb1-6"></a><span class="pp">#include </span><span class="im">&lt;algorithm&gt;</span></span>
<span id="cb1-7"><a href="#cb1-7"></a></span>
<span id="cb1-8"><a href="#cb1-8"></a><span class="at">const</span> <span class="dt">int</span> MAXN = <span class="dv">10000</span> + <span class="dv">5</span>, MAXM = <span class="dv">50000</span> + <span class="dv">5</span>;</span>
<span id="cb1-9"><a href="#cb1-9"></a></span>
<span id="cb1-10"><a href="#cb1-10"></a><span class="dt">int</span> n, m, q, ans;</span>
<span id="cb1-11"><a href="#cb1-11"></a></span>
<span id="cb1-12"><a href="#cb1-12"></a><span class="kw">struct</span> DisjointSet {</span>
<span id="cb1-13"><a href="#cb1-13"></a>    <span class="dt">int</span> fa[MAXN], rank[MAXN];</span>
<span id="cb1-14"><a href="#cb1-14"></a></span>
<span id="cb1-15"><a href="#cb1-15"></a>    <span class="dt">int</span> find(<span class="dt">int</span> x) {</span>
<span id="cb1-16"><a href="#cb1-16"></a>        <span class="cf">return</span> x == fa[x] ? x : (fa[x] = find(fa[x]));</span>
<span id="cb1-17"><a href="#cb1-17"></a>    }</span>
<span id="cb1-18"><a href="#cb1-18"></a></span>
<span id="cb1-19"><a href="#cb1-19"></a>    <span class="dt">void</span> merge(<span class="dt">int</span> x, <span class="dt">int</span> y) {</span>
<span id="cb1-20"><a href="#cb1-20"></a>        x = find(x);</span>
<span id="cb1-21"><a href="#cb1-21"></a>        y = find(y);</span>
<span id="cb1-22"><a href="#cb1-22"></a>        <span class="cf">if</span> (x == y)</span>
<span id="cb1-23"><a href="#cb1-23"></a>            <span class="cf">return</span>;</span>
<span id="cb1-24"><a href="#cb1-24"></a>        <span class="cf">if</span> (rank[x] &gt; rank[y])</span>
<span id="cb1-25"><a href="#cb1-25"></a>            <span class="bu">std::</span>swap(x, y);</span>
<span id="cb1-26"><a href="#cb1-26"></a>        <span class="cf">if</span> (rank[x] &lt; rank[y]) {</span>
<span id="cb1-27"><a href="#cb1-27"></a>            fa[x] = y;</span>
<span id="cb1-28"><a href="#cb1-28"></a>        } <span class="cf">else</span> {</span>
<span id="cb1-29"><a href="#cb1-29"></a>            <span class="cf">if</span> (rand() % <span class="dv">2</span> &gt; <span class="dv">1</span>) {</span>
<span id="cb1-30"><a href="#cb1-30"></a>                fa[x] = y;</span>
<span id="cb1-31"><a href="#cb1-31"></a>                rank[y]++;</span>
<span id="cb1-32"><a href="#cb1-32"></a>            } <span class="cf">else</span> {</span>
<span id="cb1-33"><a href="#cb1-33"></a>                fa[y] = x;</span>
<span id="cb1-34"><a href="#cb1-34"></a>                rank[x]++;</span>
<span id="cb1-35"><a href="#cb1-35"></a>            }</span>
<span id="cb1-36"><a href="#cb1-36"></a>        }</span>
<span id="cb1-37"><a href="#cb1-37"></a>    }</span>
<span id="cb1-38"><a href="#cb1-38"></a></span>
<span id="cb1-39"><a href="#cb1-39"></a>    DisjointSet(<span class="dt">int</span> n) {</span>
<span id="cb1-40"><a href="#cb1-40"></a>        <span class="cf">for</span> (<span class="dt">int</span> i = <span class="dv">1</span>; i &lt;= n; ++i) {</span>
<span id="cb1-41"><a href="#cb1-41"></a>            fa[i] = i;</span>
<span id="cb1-42"><a href="#cb1-42"></a>        }</span>
<span id="cb1-43"><a href="#cb1-43"></a>    }</span>
<span id="cb1-44"><a href="#cb1-44"></a>};</span>
<span id="cb1-45"><a href="#cb1-45"></a></span>
<span id="cb1-46"><a href="#cb1-46"></a><span class="kw">struct</span> Edge;</span>
<span id="cb1-47"><a href="#cb1-47"></a></span>
<span id="cb1-48"><a href="#cb1-48"></a>Edge *head[MAXN], *hmst[MAXN];</span>
<span id="cb1-49"><a href="#cb1-49"></a><span class="dt">int</span> cnt;</span>
<span id="cb1-50"><a href="#cb1-50"></a></span>
<span id="cb1-51"><a href="#cb1-51"></a><span class="kw">struct</span> Edge {</span>
<span id="cb1-52"><a href="#cb1-52"></a>    <span class="dt">int</span> from, to, weight;</span>
<span id="cb1-53"><a href="#cb1-53"></a>    Edge *next;</span>
<span id="cb1-54"><a href="#cb1-54"></a></span>
<span id="cb1-55"><a href="#cb1-55"></a>    Edge() {}</span>
<span id="cb1-56"><a href="#cb1-56"></a>    Edge(<span class="dt">int</span> f, <span class="dt">int</span> t, <span class="dt">int</span> w) : from(f), to(t), weight(w), next(head[f]) {}</span>
<span id="cb1-57"><a href="#cb1-57"></a>    Edge(<span class="dt">int</span> f, <span class="dt">int</span> t, <span class="dt">int</span> w, <span class="dt">int</span> flag) : from(f), to(t), weight(w), next(hmst[f]) {}</span>
<span id="cb1-58"><a href="#cb1-58"></a>} edge[MAXM];</span>
<span id="cb1-59"><a href="#cb1-59"></a></span>
<span id="cb1-60"><a href="#cb1-60"></a><span class="dt">void</span> addEdge(<span class="dt">int</span> f, <span class="dt">int</span> t, <span class="dt">int</span> w) {</span>
<span id="cb1-61"><a href="#cb1-61"></a>    head[f] = <span class="kw">new</span> Edge(f, t, w);</span>
<span id="cb1-62"><a href="#cb1-62"></a>    head[t] = <span class="kw">new</span> Edge(t, f, w);</span>
<span id="cb1-63"><a href="#cb1-63"></a>    edge[++cnt] = *head[f];</span>
<span id="cb1-64"><a href="#cb1-64"></a>}</span>
<span id="cb1-65"><a href="#cb1-65"></a><span class="dt">void</span> addMSTEdge(<span class="dt">int</span> f, <span class="dt">int</span> t, <span class="dt">int</span> w) {</span>
<span id="cb1-66"><a href="#cb1-66"></a>    hmst[f] = <span class="kw">new</span> Edge(f, t, w, <span class="dv">0</span>);</span>
<span id="cb1-67"><a href="#cb1-67"></a>    hmst[t] = <span class="kw">new</span> Edge(t, f, w, <span class="dv">0</span>);</span>
<span id="cb1-68"><a href="#cb1-68"></a>}</span>
<span id="cb1-69"><a href="#cb1-69"></a></span>
<span id="cb1-70"><a href="#cb1-70"></a><span class="dt">void</span> kruskal() {</span>
<span id="cb1-71"><a href="#cb1-71"></a>    <span class="bu">std::</span>sort(edge + <span class="dv">1</span>, edge + m + <span class="dv">1</span>, [](<span class="at">const</span> Edge &amp;a, <span class="at">const</span> Edge &amp;b) -&gt; <span class="dt">bool</span> {</span>
<span id="cb1-72"><a href="#cb1-72"></a>       <span class="cf">return</span> a.weight &gt; b.weight;</span>
<span id="cb1-73"><a href="#cb1-73"></a>    });</span>
<span id="cb1-74"><a href="#cb1-74"></a>    cnt = <span class="dv">0</span>;</span>
<span id="cb1-75"><a href="#cb1-75"></a>    DisjointSet ds(n);</span>
<span id="cb1-76"><a href="#cb1-76"></a>    <span class="cf">for</span> (<span class="dt">int</span> i = <span class="dv">1</span>; i &lt;= m; ++i) {</span>
<span id="cb1-77"><a href="#cb1-77"></a>        <span class="cf">if</span> (cnt == <span class="dv">2</span> * n - <span class="dv">2</span>)</span>
<span id="cb1-78"><a href="#cb1-78"></a>            <span class="cf">return</span>;</span>
<span id="cb1-79"><a href="#cb1-79"></a>        <span class="cf">if</span> (ds.find(edge[i].from) != ds.find(edge[i].to))</span>
<span id="cb1-80"><a href="#cb1-80"></a>        {</span>
<span id="cb1-81"><a href="#cb1-81"></a>            ds.merge(edge[i].from, edge[i].to);</span>
<span id="cb1-82"><a href="#cb1-82"></a>            addMSTEdge(edge[i].from, edge[i].to, edge[i].weight);</span>
<span id="cb1-83"><a href="#cb1-83"></a>            cnt++;</span>
<span id="cb1-84"><a href="#cb1-84"></a>        }</span>
<span id="cb1-85"><a href="#cb1-85"></a>    }</span>
<span id="cb1-86"><a href="#cb1-86"></a>}</span>
<span id="cb1-87"><a href="#cb1-87"></a></span>
<span id="cb1-88"><a href="#cb1-88"></a><span class="dt">bool</span> vis[MAXN];</span>
<span id="cb1-89"><a href="#cb1-89"></a><span class="dt">int</span> f[MAXN][<span class="dv">15</span>], dep[MAXN], log_2[MAXN], faw[MAXN];</span>
<span id="cb1-90"><a href="#cb1-90"></a></span>
<span id="cb1-91"><a href="#cb1-91"></a><span class="dt">void</span> initlog() {</span>
<span id="cb1-92"><a href="#cb1-92"></a>    <span class="cf">for</span> (<span class="dt">int</span> i = <span class="dv">1</span>; i &lt;= n; ++i) {</span>
<span id="cb1-93"><a href="#cb1-93"></a>        log_2[i] = (log_2[i - <span class="dv">1</span>]) + (<span class="dv">1</span> &lt;&lt; log_2[i - <span class="dv">1</span>] == i);</span>
<span id="cb1-94"><a href="#cb1-94"></a>    }</span>
<span id="cb1-95"><a href="#cb1-95"></a>}</span>
<span id="cb1-96"><a href="#cb1-96"></a></span>
<span id="cb1-97"><a href="#cb1-97"></a><span class="dt">void</span> dfs(<span class="dt">int</span> x, <span class="dt">int</span> fa) {</span>
<span id="cb1-98"><a href="#cb1-98"></a>    vis[x] = <span class="kw">true</span>;</span>
<span id="cb1-99"><a href="#cb1-99"></a>    f[x][<span class="dv">0</span>] = fa;</span>
<span id="cb1-100"><a href="#cb1-100"></a>    dep[x] = dep[fa] + <span class="dv">1</span>;</span>
<span id="cb1-101"><a href="#cb1-101"></a>    <span class="cf">for</span> (<span class="dt">int</span> j = <span class="dv">1</span>; (<span class="dv">1</span> &lt;&lt; j) &lt;= dep[x]; ++j) {</span>
<span id="cb1-102"><a href="#cb1-102"></a>        f[x][j] = f[f[x][j - <span class="dv">1</span>]][j - <span class="dv">1</span>];</span>
<span id="cb1-103"><a href="#cb1-103"></a>    }</span>
<span id="cb1-104"><a href="#cb1-104"></a>    <span class="cf">for</span> (Edge *e = hmst[x]; e; e = e-&gt;next) {</span>
<span id="cb1-105"><a href="#cb1-105"></a>        <span class="cf">if</span> (!vis[e-&gt;to]) {</span>
<span id="cb1-106"><a href="#cb1-106"></a>            dfs(e-&gt;to, x);</span>
<span id="cb1-107"><a href="#cb1-107"></a>            faw[e-&gt;to] = e-&gt;weight;</span>
<span id="cb1-108"><a href="#cb1-108"></a>        }</span>
<span id="cb1-109"><a href="#cb1-109"></a>    }</span>
<span id="cb1-110"><a href="#cb1-110"></a>}</span>
<span id="cb1-111"><a href="#cb1-111"></a></span>
<span id="cb1-112"><a href="#cb1-112"></a><span class="dt">int</span> lca(<span class="dt">int</span> x, <span class="dt">int</span> y) {</span>
<span id="cb1-113"><a href="#cb1-113"></a>    <span class="cf">if</span> (dep[x] &lt; dep[y])</span>
<span id="cb1-114"><a href="#cb1-114"></a>        <span class="bu">std::</span>swap(x, y);</span>
<span id="cb1-115"><a href="#cb1-115"></a>    <span class="cf">while</span> (dep[x] &gt; dep[y]) {</span>
<span id="cb1-116"><a href="#cb1-116"></a>        x = f[x][log_2[dep[x] - dep[y]] - <span class="dv">1</span>];</span>
<span id="cb1-117"><a href="#cb1-117"></a>    }</span>
<span id="cb1-118"><a href="#cb1-118"></a>    <span class="cf">if</span> (x == y)</span>
<span id="cb1-119"><a href="#cb1-119"></a>        <span class="cf">return</span> x;</span>
<span id="cb1-120"><a href="#cb1-120"></a>    <span class="cf">for</span> (<span class="dt">int</span> j = log_2[dep[x]]; j &gt;= <span class="dv">0</span>; --j) {</span>
<span id="cb1-121"><a href="#cb1-121"></a>        <span class="cf">if</span> (f[x][j] == f[y][j])</span>
<span id="cb1-122"><a href="#cb1-122"></a>            <span class="cf">continue</span>;</span>
<span id="cb1-123"><a href="#cb1-123"></a>        x = f[x][j];</span>
<span id="cb1-124"><a href="#cb1-124"></a>        y = f[y][j];</span>
<span id="cb1-125"><a href="#cb1-125"></a>    }</span>
<span id="cb1-126"><a href="#cb1-126"></a>    <span class="cf">return</span> f[x][<span class="dv">0</span>];</span>
<span id="cb1-127"><a href="#cb1-127"></a>}</span>
<span id="cb1-128"><a href="#cb1-128"></a></span>
<span id="cb1-129"><a href="#cb1-129"></a><span class="dt">int</span> main() {</span>
<span id="cb1-130"><a href="#cb1-130"></a>    scanf(<span class="st">&quot;</span><span class="sc">%d</span><span class="st"> </span><span class="sc">%d</span><span class="st">&quot;</span>, &amp;n, &amp;m);</span>
<span id="cb1-131"><a href="#cb1-131"></a>    <span class="dt">int</span> x, y, z;</span>
<span id="cb1-132"><a href="#cb1-132"></a>    <span class="cf">for</span> (<span class="dt">int</span> i = <span class="dv">1</span>; i &lt;= m; ++i) {</span>
<span id="cb1-133"><a href="#cb1-133"></a>        scanf(<span class="st">&quot;</span><span class="sc">%d</span><span class="st"> </span><span class="sc">%d</span><span class="st"> </span><span class="sc">%d</span><span class="st">&quot;</span>, &amp;x, &amp;y, &amp;z);</span>
<span id="cb1-134"><a href="#cb1-134"></a>        addEdge(x, y, z);</span>
<span id="cb1-135"><a href="#cb1-135"></a>    }</span>
<span id="cb1-136"><a href="#cb1-136"></a>    kruskal();</span>
<span id="cb1-137"><a href="#cb1-137"></a>    initlog();</span>
<span id="cb1-138"><a href="#cb1-138"></a>    <span class="cf">for</span> (<span class="dt">int</span> i = <span class="dv">1</span>; i &lt;= n; ++i) {</span>
<span id="cb1-139"><a href="#cb1-139"></a>        <span class="cf">if</span> (!vis[i])</span>
<span id="cb1-140"><a href="#cb1-140"></a>            dfs(i, <span class="dv">0</span>);</span>
<span id="cb1-141"><a href="#cb1-141"></a>    }</span>
<span id="cb1-142"><a href="#cb1-142"></a>    scanf(<span class="st">&quot;</span><span class="sc">%d</span><span class="st">&quot;</span>, &amp;q);</span>
<span id="cb1-143"><a href="#cb1-143"></a>    <span class="cf">for</span> (<span class="dt">int</span> i = <span class="dv">1</span>; i &lt;= q; ++i) {</span>
<span id="cb1-144"><a href="#cb1-144"></a>        ans = INT_MAX;</span>
<span id="cb1-145"><a href="#cb1-145"></a>        scanf(<span class="st">&quot;</span><span class="sc">%d</span><span class="st"> </span><span class="sc">%d</span><span class="st">&quot;</span>, &amp;x, &amp;y);</span>
<span id="cb1-146"><a href="#cb1-146"></a>        z = lca(x, y);</span>
<span id="cb1-147"><a href="#cb1-147"></a>        <span class="cf">if</span> (z != <span class="dv">0</span>) {</span>
<span id="cb1-148"><a href="#cb1-148"></a>            <span class="cf">while</span> (x != z) {</span>
<span id="cb1-149"><a href="#cb1-149"></a>                ans = <span class="bu">std::</span>min(ans, faw[x]);</span>
<span id="cb1-150"><a href="#cb1-150"></a>                x = f[x][<span class="dv">0</span>];</span>
<span id="cb1-151"><a href="#cb1-151"></a>            }</span>
<span id="cb1-152"><a href="#cb1-152"></a>            <span class="cf">while</span> (y != z) {</span>
<span id="cb1-153"><a href="#cb1-153"></a>                ans = <span class="bu">std::</span>min(ans, faw[y]);</span>
<span id="cb1-154"><a href="#cb1-154"></a>                y = f[y][<span class="dv">0</span>];</span>
<span id="cb1-155"><a href="#cb1-155"></a>            }</span>
<span id="cb1-156"><a href="#cb1-156"></a>            printf(<span class="st">&quot;</span><span class="sc">%d\n</span><span class="st">&quot;</span>, ans);</span>
<span id="cb1-157"><a href="#cb1-157"></a>        } <span class="cf">else</span> {</span>
<span id="cb1-158"><a href="#cb1-158"></a>            puts(<span class="st">&quot;-1&quot;</span>);</span>
<span id="cb1-159"><a href="#cb1-159"></a>        }</span>
<span id="cb1-160"><a href="#cb1-160"></a>    }</span>
<span id="cb1-161"><a href="#cb1-161"></a>    <span class="cf">return</span> <span class="dv">0</span>;</span>
<span id="cb1-162"><a href="#cb1-162"></a>}</span></code></pre></div>
<p>Finita la commedia.</p>

                </div>
            </div>
    
            <nav class="post-pagination">
    
    <a class="newer-posts" href="/2018/08/NOI2002-LegendOfTheGalaxyHeroes/">
        上一篇<br>[NOI2002] 银河英雄传说
    </a>
    
    <span class="page-number"></span>
    
</nav>

    
            

<div class="post-comment-wrapper">
    <div id="disqus_thread"></div>
</div>


        </div>
    </div>
    <div class="single-column-footer">
    Proudly published with Hexo<br>
    
    Theme <a href="https://github.com/SumiMakito/hexo-theme-journal/" target="_blank" rel="noreferrer noopener">Journal.</a> by <a href="https://mak1t0.cc/" target="_blank" rel="noreferrer noopener">Makito</a><br>
    
    &copy; 2018 <a href="https://blog.masellum.me">Mas&#39;s Blog</a>
</div>
</div>

</div>
<script src="https://cdn.jsdelivr.net/npm/jquery@3.3.1/dist/jquery.min.js"
        integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script>
<script src="https://cdn.jsdelivr.net/npm/popper.js@1.14.4/dist/umd/popper.min.js"
        integrity="sha256-EGs9T1xMHdvM1geM8jPpoo8EZ1V1VRsmcJz8OByENLA=" crossorigin="anonymous"></script>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@4.1.3/dist/js/bootstrap.min.js"
        integrity="sha256-VsEqElsCHSGmnmHXGQzvoWjWwoznFSZc6hs7ARLRacQ=" crossorigin="anonymous"></script>
<script src="https://cdn.jsdelivr.net/npm/vue@2.5.17/dist/vue.min.js"
        integrity="sha256-FtWfRI+thWlNz2sB3SJbwKx5PgMyKIVgwHCTwa3biXc=" crossorigin="anonymous"></script>
<script src="https://cdn.jsdelivr.net/npm/smooth-scroll@14.2.1/dist/smooth-scroll.polyfills.min.js"
        integrity="sha256-CI4Gq5E0io1Pv0xM3qPM+NUIOhbIBvC3GiN1Y4KhXpw=" crossorigin="anonymous"></script>
<script src="/js/journal.js?59730478"></script>


<script>
    var disqus_shortname = 'masellum-blog';
    var disqus_config = function () {
        this.page.url = 'https://blog.masellum.me/2018/08/NOIP2013-TruckTransportation/';
        this.page.identifier = '/2018/08/NOIP2013-TruckTransportation/';
    };
    (function () {
        var d = document, s = d.createElement('script');
        s.src = 'https://' + disqus_shortname + '.disqus.com/embed.js';
        s.setAttribute('data-timestamp', +new Date());
        (d.body || d.head).appendChild(s);
    })();
</script><!-- hexo-inject:begin --><!-- hexo-inject:end -->


</body>
</html>
